/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Scala library project to get you started.
 * For more details take a look at the Scala plugin chapter in the Gradle
 * user guide available at https://docs.gradle.org/4.5/userguide/scala_plugin.html
 */

// Scala and Akka versions
def scalaMajor = "2.12"
def scalaMinor = "4"


// In this section you declare where to find the dependencies of your project
allprojects {
    apply plugin: 'scala'


    repositories {
        // Use jcenter for resolving your dependencies.
        // You can declare any Maven/Ivy/file repository here.
        jcenter()
        mavenCentral()
    }

    dependencies {
        compile(
                // Scala
                [group: 'org.scala-lang', name: 'scala-compiler', version: "$scalaMajor.$scalaMinor"],
                [group: 'org.scala-lang', name: 'scala-library', version: "$scalaMajor.$scalaMinor"],
                // Kafka
                ['group': 'com.lightbend', name: "kafka-streams-scala_$scalaMajor", version: '0.1.2'],
                ['group': 'com.lightbend', name: "kafka-streams-query_$scalaMajor", version: '0.1.1'],

                // alpakka Cassandra connector
                [group: 'com.datastax.cassandra', name: 'cassandra-driver-core', version: '3.4.0'],

                // remove later
                // extras for mapping cassandra entity to scala pojo
                // https://docs.datastax.com/en/developer/java-driver/3.4/manual/custom_codecs/extras/
                [group: 'com.datastax.cassandra', name: 'cassandra-driver-extras', version: '3.4.0'],
                [group: 'com.datastax.cassandra', name: 'cassandra-driver-mapping', version: '3.4.0'],


                // alpakka
                    // Kafka connector
                [group: "com.typesafe.akka", name: "akka-stream-kafka_2.12", version: "0.19"],
                    // Cassandra connector
                [group: 'com.lightbend.akka', name: 'akka-stream-alpakka-cassandra_2.12', version: '0.17'],

                // json parser Play framework [only for verification]
                [group: 'com.typesafe.play', name: 'play-json_2.12', version: '2.6.9'],

                //Config
                [group: 'com.typesafe', name: 'config', version: '1.3.2'],
        )

        testCompile(
                [group: 'org.scalatest', name: "scalatest_$scalaMajor", version: '3.0.4'],
                [group: 'junit', name: 'junit', version: '4.12']
        )

        // Need scala-xml at test runtime
        testRuntime 'org.scala-lang.modules:scala-xml_2.11:1.0.6'
    }
    //run scala tests. These are not automatically picked up by gradle,
    //so we run them like this.
    /*
    task spec(dependsOn: ['testClasses'], type: JavaExec) {
        main = 'org.scalatest.tools.Runner'
        args = ['-R', 'build/classes/scala/test', '-o']
        classpath = sourceSets.test.runtimeClasspath
    }
    */
}

subprojects {
    apply plugin: 'application'
    // https://stackoverflow.com/a/42709164/6769651
    apply plugin: 'scala'
}

task wrapper(type: Wrapper){
	gradleVersion = "4.5"
}
